$.fn.makeTemplate=function(a){return params=jQuery.extend({user:"",template:"dados.ejs",param:"dados"},a),this.each(function(){_user=params.user,_dados=_user.models[0].attributes[params.param],_html=new EJS({url:"templates/"+params.template}).render(_dados),$(this).html(_html)})},function(){Walcart.GetUser=Backbone.Collection.extend({url:"request/usuario.json"})}($),function(){Walcart.user=new Walcart.GetUser,Walcart.UserView=Backbone.View.extend({dadosPessoais:{init:function(){this.render(),this.events()},render:function(){user=Walcart.user,user.fetch({success:function(a){$("#user-data").makeTemplate({user:a,template:"template-dados.ejs",param:"dados"})}})},events:function(){$('#nav-user li[data-page="dados"]').addClass("active").siblings().removeClass("active")}},endereco:{init:function(){this.render(),this.events()},render:function(){user=Walcart.user,user.fetch({success:function(a){$("#user-data").makeTemplate({user:a,template:"template-endereco.ejs",param:"data_enderecos"})}})},events:function(){$('#nav-user li[data-page="enderecos"]').addClass("active").siblings().removeClass("active")}},carrinho:{init:function(){this.render(),this.events()},render:function(){user=Walcart.user,user.fetch({success:function(a){$("#user-data").makeTemplate({user:a,template:"template-carrinho.ejs",param:"data_carrinho"}),_subtotal=0,$(".td-preco").each(function(){_valor=Number($(this).html().replace(".","").replace(",",".")),_subtotal+=_valor}),_subtotal=_subtotal.toFixed(2).toString(),$(".td-subtotal").html(_subtotal.replace(".",","))}})},events:function(){$('#nav-user li[data-page="carrinho"]').addClass("active").siblings().removeClass("active")}}})}($),function(){Walcart.UserRoutes=Backbone.Router.extend({routes:{"":"carrinho",dados:"dadosUsuario",enderecos:"enderecos",carrinho:"carrinho"}}),Walcart.userRouter=new Walcart.UserRoutes,Walcart.view=new Walcart.UserView,Walcart.userRouter.on({"route:dadosUsuario":function(){Walcart.view.dadosPessoais.init()},"route:enderecos":function(){Walcart.view.endereco.init()},"route:carrinho":function(){Walcart.view.carrinho.init()}})}($),Backbone.history.start();